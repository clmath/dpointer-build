define("dpointer/events",["./handlers/utils","./handlers/touch","./handlers/mouse","./handlers/mspointer"],function(a,b,c,d){"use strict";function e(b){var c=document.createElement("style"),d=a.TouchAction.ATTR_NAME;c.textContent="["+d+"='none']  { "+b+": none; }["+d+"='auto']  { "+b+": auto; }["+d+"='pan-x'] { "+b+": pan-x; }["+d+"='pan-y'] { "+b+": pan-y; }["+d+"='pan-x pan-y'],["+b+"='pan-y pan-x'] { "+b+": pan-x pan-y; }",document.head.insertBefore(c,document.head.firstChild)}var f={_targetElement:null},g={touch:"ontouchstart"in document,pointer:!!window.navigator.pointerEnabled,mspointer:!!window.navigator.msPointerEnabled,chrome:/chrome/i.test(navigator.userAgent),mobile:/(mobile)|(android)/i.test(navigator.userAgent)};return f.enable=function(e){e=e||window.document,this._targetElement||(g.pointer||(g.mspointer?d.registerHandlers(e):g.touch?g.mobile?b.registerHandlers(e):(c.registerHandlers(e),g.chrome&&b.registerHandlers(e)):c.registerHandlers(e)),a.registerClickHandler(),this._targetElement=e)},f.disable=function(){this._targetElement&&(b.deregisterHandlers(this._targetElement),c.deregisterHandlers(this._targetElement),d.deregisterHandlers(this._targetElement),a.deregisterClickHandler()),this._targetElement=null},f.setTouchAction=function(b,c){b.setAttribute(a.TouchAction.ATTR_NAME,c)},f.setPointerCapture=function(a,d){return this._targetElement?g.pointer?a.setPointerCapture(d):g.mspointer?a.msSetPointerCapture(d):1===d?c.setPointerCapture(a):b.setPointerCapture(a,d):!1},f.releasePointerCapture=function(a,d){return this._targetElement?g.pointer?a.releasePointerCapture(d):g.mspointer?a.msReleasePointerCapture(d):1===d?c.releasePointerCapture(a):b.releasePointerCapture(a,d):!1},g.pointer&&e("touch-action"),g.mspointer&&e("-ms-touch-action"),f.enable(),f}),define("dpointer/handlers/mouse",["./utils"],function(a){"use strict";function b(b){j.update(b),a.dispatchEvent(b.target,g(a.events.DOWN,b,{}));var c=window.getComputedStyle(b.target).overflow;!c||"auto"!==c&&"scroll"!==c||(i=!0,a.dispatchEvent(b.target,g(a.events.CANCEL,b,{})))}function c(b){i||(a.dispatchEvent(j.identifyTarget(b.target),g(a.events.MOVE,b,{})),j.update(b))}function d(b){i||j.hasCapture()||(b.relatedTarget&&(a.dispatchEvent(b.target,g(a.events.OUT,b,{})),a.dispatchLeaveEvents(b.target,b.relatedTarget,g(a.events.LEAVE,b,{bubbles:!1}))),j.update(b))}function e(b){i||j.hasCapture()||(b.relatedTarget&&(a.dispatchEvent(b.target,g(a.events.OVER,b,{})),a.dispatchEnterEvents(b.target,b.relatedTarget,g(a.events.ENTER,b,{bubbles:!1}))),j.update(b))}function f(b){i?i=!1:(a.dispatchEvent(j.identifyTarget(b.target),g(a.events.UP,b,{})),j.implicitReleaseCapture(),j.update(b))}function g(b,c,d){d=d||{},d.screenX=c.screenX,d.screenY=c.screenY,d.clientX=c.clientX,d.clientY=c.clientY,d.ctrlKey=c.ctrlKey,d.altKey=c.altKey,d.shiftKey=c.shiftKey,d.metaKey=c.metaKey;var e=c.button,f=void 0!==c.buttons?c.buttons:a.which2buttons(c.which);return("mousemove"===c.type||"mouseup"===c.type)&&(e=0),d.button=e,d.buttons=f,d.which=e+1,d.relatedTarget=j.hasCapture()?null:c.relatedTarget,d.pointerId=1,d.pointerType="mouse",d.isPrimary=!0,new a.Pointer(b,c,d)}var h={mousedown:"mousedown",mousemove:"mousemove",mouseout:"mouseout",mouseover:"mouseover",mouseup:"mouseup"},i=!1,j={_lastNativeEvent:null,_captureTarget:null,register:function(){},update:function(a){this._lastNativeEvent=a},setCapture:function(b){if(!this._lastNativeEvent)throw"InvalidPointerId";return 0===this._lastNativeEvent.buttons?!1:(this._captureTarget=b,a.dispatchEvent(this._lastNativeEvent.target,g(a.events.GOTCAPTURE,this._lastNativeEvent,{})),!0)},hasCapture:function(){return!!this._captureTarget},identifyTarget:function(a){return this._captureTarget||a},releaseCapture:function(b,c){if(!this._lastNativeEvent)throw"InvalidPointerId";return c||this._captureTarget===b?(this._captureTarget&&(a.dispatchEvent(this._captureTarget,g(a.events.LOSTCAPTURE,this._lastNativeEvent,{})),this._captureTarget=null),!0):!1},implicitReleaseCapture:function(){return this.releaseCapture(null,!0)}};return{registerHandlers:function(g){g=g||window.document,a.addEventListener(g,h.mousedown,b,!0),a.addEventListener(g,h.mousemove,c,!0),a.addEventListener(g,h.mouseout,d,!0),a.addEventListener(g,h.mouseover,e,!0),a.addEventListener(g,h.mouseup,f,!0)},deregisterHandlers:function(g){a.removeEventListener(g,h.mousedown,b,!0),a.removeEventListener(g,h.mousemove,c,!0),a.removeEventListener(g,h.mouseout,d,!0),a.removeEventListener(g,h.mouseover,e,!0),a.removeEventListener(g,h.mouseup,f,!0)},setPointerCapture:function(a){return j.setCapture(a)},releasePointerCapture:function(a){return j.releaseCapture(a,!1)}}}),define("dpointer/handlers/mspointer",["./utils"],function(a){"use strict";function b(b){a.dispatchEvent(b.target,j(a.events.DOWN,b,{}))}function c(b){a.dispatchEvent(b.target,j(a.events.MOVE,b,{}))}function d(b){a.dispatchEvent(b.target,j(a.events.UP,b,{}))}function e(b){a.dispatchEvent(b.target,j(a.events.OUT,b,{})),a.dispatchLeaveEvents(b.target,b.relatedTarget,j(a.events.LEAVE,b,{bubbles:!1}))}function f(b){a.dispatchEvent(b.target,j(a.events.OVER,b,{})),a.dispatchEnterEvents(b.target,b.relatedTarget,j(a.events.ENTER,b,{bubbles:!1}))}function g(b){a.dispatchEvent(b.target,j(a.events.CANCEL,b,{}))}function h(b){a.dispatchEvent(b.target,j(a.events.GOTCAPTURE,b,{}))}function i(b){a.dispatchEvent(b.target,j(a.events.LOSTCAPTURE,b,{}))}function j(b,c,d){return d=d||{},d.bubbles=c.bubbles,d.cancelable=c.cancelable,d.view=c.view,d.detail=c.detail,d.screenX=c.screenX,d.screenY=c.screenY,d.clientX=c.clientX,d.clientY=c.clientY,d.ctrlKey=c.ctrlKey,d.altKey=c.altKey,d.shiftKey=c.shiftKey,d.metaKey=c.metaKey,d.button=c.button,d.buttons=c.buttons,d.relatedTarget=c.relatedTarget,d.pointerId=c.pointerId,d.width=c.width,d.height=c.height,d.pressure=c.pressure,d.tiltX=c.tiltX,d.tiltY=c.tiltY,d.pointerType=k(c.pointerType),d.hwTimestamp=c.hwTimestamp,d.isPrimary=c.isPrimary,-1===d.button&&"touch"===d.pointerType&&(d.buttons=1),new a.Pointer(b,c,d)}function k(a){switch(a){case 2:return"touch";case 3:return"pen";case 4:return"mouse";default:return a}}var l={MSPointerDown:"MSPointerDown",MSPointerMove:"MSPointerMove",MSPointerUp:"MSPointerUp",MSPointerOut:"MSPointerOut",MSPointerOver:"MSPointerOver",MSPointerCancel:"MSPointerCancel",MSGotPointerCapture:"MSGotPointerCapture",MSLostPointerCapture:"MSLostPointerCapture"};return{registerHandlers:function(j){j=j||window.document,a.addEventListener(j,l.MSPointerDown,b,!0),a.addEventListener(j,l.MSPointerMove,c,!0),a.addEventListener(j,l.MSPointerUp,d,!0),a.addEventListener(j,l.MSPointerOut,e,!0),a.addEventListener(j,l.MSPointerOver,f,!0),a.addEventListener(j,l.MSPointerCancel,g,!0),a.addEventListener(j,l.MSGotPointerCapture,h,!0),a.addEventListener(j,l.MSLostPointerCapture,i,!0)},deregisterHandlers:function(j){a.removeEventListener(j,l.MSPointerDown,b,!0),a.removeEventListener(j,l.MSPointerMove,c,!0),a.removeEventListener(j,l.MSPointerUp,d,!0),a.removeEventListener(j,l.MSPointerOut,e,!0),a.removeEventListener(j,l.MSPointerOver,f,!0),a.removeEventListener(j,l.MSPointerCancel,g,!0),a.removeEventListener(j,l.MSGotPointerCapture,h,!0),a.removeEventListener(j,l.MSLostPointerCapture,i,!0)}}}),define("dpointer/handlers/touch",["./utils"],function(a){"use strict";function b(b){for(var c,d,e,g=b.changedTouches.length,h=0;g>h;h++)if(c=b.changedTouches.item(h),d=null,e=a.getTouchAction(c.target),k.hasPrimary()&&e===a.TouchAction.AUTO){var i=k.getPrimaryTouchEvent(),l=k.getPrimaryTouch();d=k.identifyPrimaryTouchTarget(l.target),a.dispatchEvent(d,f(a.events.OUT,i,l,{})),a.dispatchEvent(d,f(a.events.CANCEL,i,l,{})),k.implicitReleaseCapture(l.identifier),k.unregister(l.identifier)}else e!==a.TouchAction.AUTO&&j.isEligible(c.target)&&b.preventDefault(),k.register(c.identifier,e),k.update(c,b,c.target),a.dispatchEvent(c.target,f(a.events.OVER,b,c,{})),a.dispatchEvent(c.target,f(a.events.DOWN,b,c,{}))}function c(b){for(var c,d=b.changedTouches.length,e=0;d>e;e++){if(c=b.changedTouches.item(e),!k.isActive(c.identifier))return;if(k.getTouchAction(c.identifier)===a.TouchAction.AUTO){var g=k.getTouchEvent(c.identifier).type;switch(g){case i.touchstart:a.dispatchEvent(c.target,f(a.events.OUT,b,c,{})),a.dispatchEvent(c.target,f(a.events.CANCEL,b,c,{}));break;case i.touchmove:}k.implicitReleaseCapture(c.identifier),k.unregister(c.identifier)}else{var j=k.identifyTouchTarget(c.identifier,h(c)),l=k.getTargetElement(c.identifier);j!==l?(a.dispatchEvent(l,f(a.events.OUT,b,c,{relatedTarget:j})),a.dispatchLeaveEvents(l,j,f(a.events.LEAVE,b,c,{relatedTarget:j,bubbles:!1})),a.dispatchEvent(j,f(a.events.MOVE,b,c,{})),a.dispatchEvent(j,f(a.events.OVER,b,c,{relatedTarget:l})),a.dispatchEnterEvents(j,l,f(a.events.ENTER,b,c,{relatedTarget:l,bubbles:!1}))):a.dispatchEvent(j,f(a.events.MOVE,b,c,{})),k.update(c,b,j),b.preventDefault()}}}function d(b){for(var c,d=b.changedTouches.length,e=0;d>e;e++){if(c=b.changedTouches.item(e),!k.isActive(c.identifier))return;var j=k.getTouchEvent(c.identifier).type,l=h(c)||c.target,m=k.identifyTouchTarget(c.identifier,l);if(k.getTouchAction(c.identifier)===a.TouchAction.AUTO)switch(j){case i.touchmove:break;case i.touchstart:a.dispatchEvent(m,f(a.events.MOVE,b,c,{})),a.dispatchEvent(m,f(a.events.UP,b,c,{})),a.dispatchEvent(m,f(a.events.OUT,b,c,{}))}else switch(j){case i.touchstart:a.dispatchEvent(m,f(a.events.MOVE,b,c,{})),a.dispatchEvent(m,f(a.events.UP,b,c,{})),g(m,c),a.dispatchEvent(m,f(a.events.OUT,b,c,{}));break;case i.touchmove:a.dispatchEvent(m,f(a.events.UP,b,c,{})),l===c.target&&g(m,c),a.dispatchEvent(m,f(a.events.OUT,b,c,{}))}k.implicitReleaseCapture(c.identifier),k.unregister(c.identifier)}}function e(b){for(var c,d=b.changedTouches.length,e=0;d>e;e++){if(c=b.changedTouches.item(e),!k.isActive(c.identifier))return;a.dispatchEvent(k.identifyTouchTarget(c.identifier,h(c)),f(a.events.CANCEL,b,c,{})),k.implicitReleaseCapture(c.identifier),k.unregister(c.identifier)}}function f(b,c,d,e){return e=e||{},e.screenX=d.screenX,e.screenY=d.screenY,e.clientX=d.clientX,e.clientY=d.clientY,e.ctrlKey=c.ctrlKey,e.altKey=c.altKey,e.shiftKey=c.shiftKey,e.metaKey=c.metaKey,k.hasCapture(d.identifier)&&(e.relatedTarget=null),e.button=0,e.buttons=1,e.which=1,e.pointerId=d.identifier+2,e.pointerType="touch",e.isPrimary=k.isPrimary(d.identifier),new a.Pointer(b,c,e)}function g(b,c){k.isPrimary(c.identifier)&&(a.dispatchEvent(b,a.createSyntheticClick(c)),j.isEligible(b)?(a.dispatchEvent(b,a.createSyntheticClick(c,!0)),j.hasFirstClick=!1):(j.hasFirstClick=!0,j.lastClickTS=(new Date).getTime(),j.targetElement=b))}function h(a){return a.target.ownerDocument.elementFromPoint(a.pageX,a.pageY)}var i={touchstart:"touchstart",touchmove:"touchmove",touchend:"touchend",touchcancel:"touchcancel"},j={TAP_DELAY:250,lastClickTS:0,hasFirstClick:!1,targetElement:null,isEligible:function(a){return this.hasFirstClick&&this.targetElement===a&&(new Date).getTime()-this.lastClickTS<this.TAP_DELAY}},k={primaryTouchId:-1,register:function(a,b){-1===this.primaryTouchId&&(this.primaryTouchId=a),this[a]={},this[a]._touchAction=b},update:function(a,b,c){this[a.identifier]._lastTouch=a,this[a.identifier]._lastNativeEvent=b,this[a.identifier]._lastTargetElement=c},getTouchAction:function(a){return this[a]._touchAction},getTouch:function(a){return this[a]._lastTouch},getTouchEvent:function(a){return this[a]._lastNativeEvent},getTargetElement:function(a){return this[a]._lastTargetElement},unregister:function(a){return this.primaryTouchId===a&&(this.primaryTouchId=-1),delete this[a]},isActive:function(a){return a in this},identifyTouchTarget:function(a,b){return this[a]&&this[a]._captureTarget||b},hasPrimary:function(){return-1!==this.primaryTouchId},isPrimary:function(a){return this.primaryTouchId===a},getPrimaryTouchEvent:function(){return this[this.primaryTouchId]._lastNativeEvent},getPrimaryTouch:function(){return this[this.primaryTouchId]._lastTouch},identifyPrimaryTouchTarget:function(a){return this.identifyTouchTarget(this.primaryTouchId,a)},setCapture:function(b,c){if(!this.isActive(b))throw"InvalidPointerId";return this[b]._captureTarget=c,a.dispatchEvent(this.getTouch(b).target,f(a.events.GOTCAPTURE,this.getTouchEvent(b),this.getTouch(b),{})),!0},hasCapture:function(a){return!!this[a]._captureTarget},releaseCapture:function(b,c,d){if(!this.isActive(b))throw"InvalidPointerId";return d||this[b]._captureTarget===c?(this[b]._captureTarget&&(this[b]._captureTarget=null,a.dispatchEvent(k.getTouch(b).target,f(a.events.LOSTCAPTURE,k.getTouchEvent(b),k.getTouch(b),{}))),!0):!1},implicitReleaseCapture:function(a){return this.releaseCapture(a,null,!0)}};return{registerHandlers:function(f){f=f||window.document,a.addEventListener(f,i.touchstart,b,!0),a.addEventListener(f,i.touchmove,c,!0),a.addEventListener(f,i.touchend,d,!0),a.addEventListener(f,i.touchcancel,e,!0)},deregisterHandlers:function(f){a.removeEventListener(f,i.touchstart,b,!0),a.removeEventListener(f,i.touchmove,c,!0),a.removeEventListener(f,i.touchend,d,!0),a.removeEventListener(f,i.touchcancel,e,!0)},setPointerCapture:function(a,b){return k.setCapture(b-2,a)},releasePointerCapture:function(a,b){return k.releaseCapture(b-2,a,!1)}}}),define("dpointer/handlers/utils",[],function(){"use strict";function a(a,b){if(f.SUPPORT_MOUSE_EVENT_CONSTRUCTOR)return new MouseEvent(a,b);var c=document.createEvent("MouseEvents");return c.initMouseEvent(a,b.bubbles,b.cancelable,b.view||null,b.detail||null,b.screenX||0,b.screenY||0,b.clientX||0,b.clientY||0,b.ctrlKey||!1,b.altKey||!1,b.shiftKey||!1,b.metaKey||!1,b.button||0,b.relatedTarget||null),c}function b(a,b){"buttons"in a?Object.defineProperty(a,"buttons",{get:function(){return b},enumerable:!0}):Object.defineProperty(a,"buttons",{value:b||0,enumerable:!0,writable:!1})}function c(a,b){Object.defineProperties(a,{pointerId:{value:b.pointerId||0,enumerable:!0},width:{value:b.width||0,enumerable:!0},height:{value:b.height||0,enumerable:!0},pressure:{value:b.pressure||0,enumerable:!0},tiltX:{value:b.tiltX||0,enumerable:!0},tiltY:{value:b.tiltY||0,enumerable:!0},pointerType:{value:b.pointerType||"",enumerable:!0},hwTimestamp:{value:b.hwTimestamp||0,enumerable:!0},isPrimary:{value:b.isPrimary||!1,enumerable:!0}})}function d(a,b){if(a.type!==f.GOTCAPTURE&&a.type!==f.LOSTCAPTURE){var c=a.stopPropagation,d=a.preventDefault;a.stopPropagation=function(){b.stopPropagation(),c.apply(this)},a.preventDefault=function(){b.preventDefault(),d.apply(this)}}}function e(a){return"ontouchstart"in document&&f.isNativeClickEvent(a)&&f.getTouchAction(a.target)!==f.TouchAction.AUTO?(a.preventDefault(),a.stopImmediatePropagation(),!1):!0}var f={events:{DOWN:"pointerdown",UP:"pointerup",CANCEL:"pointercancel",MOVE:"pointermove",OVER:"pointerover",OUT:"pointerout",ENTER:"pointerenter",LEAVE:"pointerleave",GOTCAPTURE:"gotpointercapture",LOSTCAPTURE:"lostpointercapture"},TouchAction:{ATTR_NAME:"touch-action",AUTO:0,PAN_X:1,PAN_Y:2,NONE:3},SUPPORT_MOUSE_EVENT_CONSTRUCTOR:!1};try{new MouseEvent("mousedown",{}),f.SUPPORT_MOUSE_EVENT_CONSTRUCTOR=!0}catch(g){}return f.getTouchAction=function(a){var b=f.TouchAction.AUTO;do switch(a.getAttribute&&a.getAttribute(f.TouchAction.ATTR_NAME)){case"auto":b|=f.TouchAction.AUTO;break;case"pan-x":b|=f.TouchAction.PAN_X;break;case"pan-y":b|=f.TouchAction.PAN_Y;break;case"none":b|=f.TouchAction.NONE}while(b!==f.TouchAction.NONE&&(a=a.parentNode));return b},f.Pointer=function(e,f,g){g=g||{},g.bubbles="bubbles"in g?g.bubbles:!0,g.cancelable=g.cancelable||!0;var h=a(e,g);return b(h,g.buttons),c(h,g),d(h,f),h},f.createSyntheticClick=function(a,b){var c=document.createEvent("MouseEvents");return void 0===c.isTrusted&&Object.defineProperty(c,"isTrusted",{value:!1,enumerable:!0,writable:!1,configurable:!1}),c.initMouseEvent(b?"dblclick":"click",!0,!0,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,null),c},f.isNativeClickEvent=function(a){return void 0===a.isTrusted||a.isTrusted},f.which2buttons=function(a){switch(a){case 0:return 0;case 1:return 1;case 2:return 4;case 3:return 2;default:return Math.pow(2,a-1)}},f.addEventListener=function(a,b,c,d){a.addEventListener(b,c,d)},f.removeEventListener=function(a,b,c,d){a.removeEventListener(b,c,d)},f.dispatchEvent=function(a,b){if(!a)return!1;if(!a.dispatchEvent)throw new Error("dispatchEvent not supported on targetElement");return a.dispatchEvent(b)},f.dispatchLeaveEvents=function(a,b,c){return null==a||null==b||a===b||16&a.compareDocumentPosition(b)?!0:this.dispatchEvent(a,c)&&this.dispatchLeaveEvents(a.parentNode,b,c)},f.dispatchEnterEvents=function(a,b,c){return null==a||null==b||a===b||16&a.compareDocumentPosition(b)?!0:this.dispatchEnterEvents(a.parentNode,b,c)&&this.dispatchEvent(a,c)},f.registerClickHandler=function(){f.addEventListener(window.document,"click",e,!0)},f.deregisterClickHandler=function(){f.removeEventListener(window.document,"click",e,!0)},f});
//# sourceMappingURL=layer.map